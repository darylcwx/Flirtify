<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flirtify Home</title>

    <!-- FAVICON -->
    <link
      rel="icon"
      type="image/x-icon"
      href="../images/flirtify-favicon.png"
    />

    <!-- CSS Style -->
    <link rel="stylesheet" href="../style/style.css" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx"
      crossorigin="anonymous"
    />

    <!-- FONTAWESOME -->
    <script
      src="https://kit.fontawesome.com/fe33c26b25.js"
      crossorigin="anonymous"
    ></script>

    <!-- JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- VueJS -->
    <script src="https://unpkg.com/vue@next"></script>

    <!-- AXIOS -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    
  </head>

  {% include 'navbar.html' % }

  <body id="app""">
    <!-- MATCH CARD -->
    <div class="person">
      <div class="card">
        <img
          src="../images/flirtify.png"
          class="card-img-top d-flex justify-content-center"
          alt="flirtify"
        />
        <div class="card-body">
          <div class="container">
            <div class="row justify-content-between">
              <div class="col-4">
                <h5 class="card-title fs-5">Wasooz</h5>
              </div>
              <div class="col-3">
                <div
                  class="p-2 border border-danger border-3 rounded-pill rounded-5 text-danger text-center score">
                    {{result}}
                </div>
              </div>
            </div>
          </div>
          <p class="card-text ms-3 mt-2 person-content">
            I voted! for ***fool and caching my cp
          </p>

          <div id="more-content">
            <!-- use li when using vue to get info -->
            <li class="card-text ms-3 person-content">Age:</li>
            <li class="card-text ms-3 person-content">Occupation:</li>
            <li class="card-text ms-3 person-content">Hobby:</li>
            <li class="card-text ms-3 person-content">
              More Description goes here
            </li>
          </div>

          <a href="#" id="read-more" class="fs-6 ms-3 mt-3 text-danger-emphasis"
            >Read More</a
          >

          <!-- FORM FOR MATCHING -->
          <form>
            <div class="container text-center mt-4">
              <div class="row justify-content-between">
                <div class="col-5">
                  <!-- BUTTON TRIGGERS THE NEXT CARD -->
                  <button type="button" class="btn btn-lg btn-secondary">
                    Next
                  </button>
                </div>
                <div class="col-5">
                  <button
                    type="button"
                    class="btn btn-lg btn-danger"
                    data-bs-toggle="modal"
                    data-bs-target="#matchModal"
                  >
                    <i class="fa-solid fa-heart"></i>
                  </button>
                </div>
              </div>
            </div>
          </form>

          <!-- IF MATCH -->
          <div
            class="modal fade"
            id="matchModal"
            tabindex="-1"
            aria-labelledby="matchModalLabel"
            aria-hidden="true"
          >
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="matchModalLabel">
                    Matched!
                  </h1>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                    aria-label="Close"
                  ></button>
                </div>
                <div class="modal-body">
                  <!-- DISPLAY MATCH PICTURE HERE -->
                  <!-- <img src="" alt=""> -->
                  <p class="text-center fw-bold">IT'S A MATCH!</p>
                </div>
                <div class="modal-footer">
                  <button
                    type="button"
                    class="btn btn-secondary"
                    data-bs-dismiss="modal"
                  >
                    Close
                  </button>
                  <button type="button" class="btn btn-danger">Chat Now</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- <div id="app" class="container-fluid">{{ result }}</div> -->

    <script>

      document
        .getElementById("read-more")
        .addEventListener("click", function () {
          event.preventDefault();
          moreContent = document.getElementById("more-content");
          if (moreContent.style.display === "none") {
            moreContent.style.display = "block";
            this.innerHTML = "Read Less";
          } else {
            moreContent.style.display = "none";
            this.innerHTML = "Read More";
          }
        });

      // Querying the microservices
      // var matchURL = '/create_match';
      // var compatLink = '/get_compatibility/';

      // var userURL =
      // axios.get()

      // axios.post('/create_match', {
      //     // user_chooser_id: 1,
      //     // user_suggested_id: 2,
      //     // decision: 1
      //     })
      //     .then(response => {
      //         console.log(response.data);
      //         // Creating potential matches from db
      //         var matches = response.data;

      //     })
      //     .catch(function (error) {
      //         console.log(error);
      //     });

      const app = Vue.createApp({
        data() {
          return {
            // matches: []
            result : "",
            // userName: "",
            // userMatches: ""
          };
        },

        created(){
            // axios.get()
            // fetch('http://localhost:5000/matches')
            // .then(response => response.json())
            // .then(data => {
            //     this.matches = data;
            //     console.log(this.matches);
            // })
            // this.getAll()
        },

        methods: {
          getCompatScore() {
            axios.get();
            fetch(
              "http://localhost:7100/get_compatibility/848395333569937409/848395333575245825"
            //   "http://localhost:7100/get_compatibility/"+this.user1id+"/"+user2id+"
            //   "http://localhost:7100/get_compatibility/<current user id>/<number of people>"
            )
              .then((response) => response.json())
              .then((data) => {
                // Getting the compatibility score from compatiblility microservice
                this.result = Math.round(parseInt(data['data']['compatibility_result']));
                this.result = this.result.toString() + "%";
                console.log(this.result);
              });
          },

          getUserDetails() {
           // Getting the user details from user microservice
           axios.get();
            fetch(
              "http://127.0.0.1:26257/user"
            // "http://127.0.0.1:26257/user" + this.user1id;
            )
              .then((response) => response.json())
              .then((data) => {
                // Getting the compatibility score from compatiblility microservice
                this.result = Math.round(parseInt(data['data']['compatibility_result']));
                this.result = this.result.toString() + "%";
                console.log(this.result);
              });
          }
        },

        mounted() {
            this.getUserDetails();
            this.getCompatScore();
        },

        computed: {},
      });

      app.mount("#app");
    </script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
